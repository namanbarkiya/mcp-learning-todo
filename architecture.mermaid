graph TB
    %% User Interface Layer
    subgraph "Frontend - Next.js 14"
        UI[User Interface]
        Auth[Authentication Pages]
        Dashboard[Dashboard/Todo List]
        Components[React Components]
        API_Routes[Next.js API Routes]
    end

    %% Backend Layer
    subgraph "Backend - FastAPI"
        FastAPI[FastAPI Server]
        Auth_API[Authentication API]
        Todo_API[Todo CRUD API]
        MCP_Client[MCP Client Integration]
        CSV_Service[CSV Data Service]
        Pandas[Pandas Data Operations]
    end

    %% MCP Server Layer
    subgraph "MCP Server - Python"
        MCP_Server[MCP Server Core]
        JSON_RPC[JSON-RPC 2.0 Protocol]
        
        subgraph "MCP Tools"
            Create_Tool[create_todo]
            List_Tool[list_todos]
            Update_Tool[update_todo]
            Delete_Tool[delete_todo]
            Search_Tool[search_todos]
            Category_Tool[manage_categories]
            Validate_Tool[validate_data]
        end
        
        subgraph "MCP Resources"
            CSV_Resource[CSV Data Access]
            File_Resource[File System Access]
            User_Context[User Context]
            Backup_Resource[Data Backup/Restore]
        end
        
        subgraph "MCP Prompts"
            Task_Creation[Structured Task Creation]
            Data_Validation[Input Validation]
            Search_Prompts[Search & Filter Prompts]
            Category_Prompts[Category Management]
        end
    end

    %% Data Storage Layer
    subgraph "Data Storage - CSV Files"
        Todos_CSV[todos.csv<br/>- id, user_id, title<br/>- description, priority<br/>- due_date, completed<br/>- timestamps, category]
        Users_CSV[users.csv<br/>- id, username, email<br/>- password_hash<br/>- timestamps, preferences]
        Categories_CSV[categories.csv<br/>- id, name, description<br/>- color, user_id]
    end

    %% External Services (Future Scope)
    subgraph "External Services (Future)"
        Weather_API[Weather API]
        Calendar_API[Calendar Integration]
        Email_Service[Email Notifications]
    end

    %% Deployment Layer
    subgraph "Deployment"
        Vercel[Vercel<br/>Frontend Hosting]
        Railway[Railway/Render<br/>Backend Hosting]
        File_Storage[Persistent File Storage<br/>CSV Files]
    end

    %% User Interactions
    User[User] --> UI
    User --> Auth
    User --> Dashboard

    %% Frontend Internal Flow
    UI --> Components
    Auth --> API_Routes
    Dashboard --> API_Routes
    Components --> API_Routes

    %% Frontend to Backend Communication
    API_Routes --> FastAPI
    API_Routes --> Auth_API
    API_Routes --> Todo_API

    %% Backend Internal Flow
    FastAPI --> Auth_API
    FastAPI --> Todo_API
    FastAPI --> MCP_Client
    Auth_API --> CSV_Service
    Todo_API --> CSV_Service
    CSV_Service --> Pandas

    %% Backend to MCP Server Communication
    MCP_Client --> MCP_Server
    MCP_Server --> JSON_RPC

    %% MCP Server Internal Flow
    JSON_RPC --> Create_Tool
    JSON_RPC --> List_Tool
    JSON_RPC --> Update_Tool
    JSON_RPC --> Delete_Tool
    JSON_RPC --> Search_Tool
    JSON_RPC --> Category_Tool
    JSON_RPC --> Validate_Tool

    %% MCP Tools to Resources
    Create_Tool --> CSV_Resource
    List_Tool --> CSV_Resource
    Update_Tool --> CSV_Resource
    Delete_Tool --> CSV_Resource
    Search_Tool --> CSV_Resource
    Category_Tool --> CSV_Resource
    Validate_Tool --> CSV_Resource

    %% MCP Resources to Data
    CSV_Resource --> Todos_CSV
    CSV_Resource --> Users_CSV
    CSV_Resource --> Categories_CSV
    File_Resource --> Backup_Resource
    User_Context --> Users_CSV

    %% MCP Prompts Integration
    Task_Creation --> Create_Tool
    Data_Validation --> Validate_Tool
    Search_Prompts --> Search_Tool
    Category_Prompts --> Category_Tool

    %% Data Flow
    Pandas --> Todos_CSV
    Pandas --> Users_CSV
    Pandas --> Categories_CSV

    %% Deployment Connections
    UI -.-> Vercel
    FastAPI -.-> Railway
    MCP_Server -.-> Railway
    Todos_CSV -.-> File_Storage
    Users_CSV -.-> File_Storage
    Categories_CSV -.-> File_Storage

    %% Security Layer
    subgraph "Security & Authentication"
        JWT[JWT Tokens]
        CORS[CORS Configuration]
        Validation[Input Validation]
        Rate_Limit[Rate Limiting]
    end

    %% Security Connections
    Auth_API --> JWT
    FastAPI --> CORS
    FastAPI --> Validation
    FastAPI --> Rate_Limit

    %% Styling
    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef mcp fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef data fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef external fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef deployment fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef security fill:#ffebee,stroke:#b71c1c,stroke-width:2px

    class UI,Auth,Dashboard,Components,API_Routes frontend
    class FastAPI,Auth_API,Todo_API,MCP_Client,CSV_Service,Pandas backend
    class MCP_Server,JSON_RPC,Create_Tool,List_Tool,Update_Tool,Delete_Tool,Search_Tool,Category_Tool,Validate_Tool,CSV_Resource,File_Resource,User_Context,Backup_Resource,Task_Creation,Data_Validation,Search_Prompts,Category_Prompts mcp
    class Todos_CSV,Users_CSV,Categories_CSV data
    class Weather_API,Calendar_API,Email_Service external
    class Vercel,Railway,File_Storage deployment
    class JWT,CORS,Validation,Rate_Limit security